<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì˜ë‹¨ì–´ ì™¸ìš°ê¸° í”„ë¡œê·¸ë¨</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background-color: #f9f9f9; }
    textarea { width: 100%; height: 180px; margin-bottom: 10px; }
    button { padding: 10px 20px; font-size: 16px; }
    #quizBox, #scoreBox { display: none; margin-top: 30px; padding: 20px; background: #fff; border: 1px solid #ccc; border-radius: 8px; }
    input[type="text"] { width: 100%; padding: 8px; margin-top: 10px; }
    .result { margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>

  <!-- ë‹¨ì–´ ì…ë ¥ ì˜ì—­ -->
  <div id="inputSection">
    <h2>ğŸ“ ì™¸ìš¸ ë‹¨ì–´ ì…ë ¥</h2>
    <p><strong>í˜•ì‹:</strong> ì˜ë‹¨ì–´:ëœ» (ë‹¤ìŒë‹¨ì–´ë¥¼ ì‘ì„±í•  ë•ŒëŠ” ì—”í„°ë¥¼ ëˆŒëŸ¬ ë°‘ì— ì¤„ì— ì‘ì„±í•´ì£¼ì„¸ìš”!)</p>
    <textarea id="wordInput" placeholder="ì˜ˆ: apple:ì‚¬ê³¼\nbanana:ë°”ë‚˜ë‚˜"></textarea><br>
    <button onclick="startQuiz()">í€´ì¦ˆ ì‹œì‘</button>
  </div>

  <!-- í€´ì¦ˆ ì˜ì—­ -->
  <div id="quizBox">
    <h2>ğŸ“˜ ëœ»ì„ ë§ì¶°ë³´ì„¸ìš”!</h2>
    <p>ë‹¨ì–´: <strong id="wordText" style="font-size: 1.4em;"></strong></p>
    <input type="text" id="userAnswer" placeholder="ëœ»ì„ ì…ë ¥í•˜ì„¸ìš”" />
    <button onclick="checkAnswer()">ì •ë‹µ í™•ì¸</button>
    <p class="result" id="resultMsg"></p>
  </div>

  <!-- ì ìˆ˜ ìš”ì•½ -->
  <div id="scoreBox">
    <h2>âœ… í€´ì¦ˆ ê²°ê³¼</h2>
    <p id="scoreSummary"></p>
    <button onclick="goToInput()">ë‹¨ì–´ ë‹¤ì‹œ ì…ë ¥í•˜ê¸°</button>
  </div>

  <script>
    let allWords = [];
    let quizSet = [];
    let currentIndex = 0;
    let currentWord = null;
    let correctCount = 0;
    let incorrectCount = 0;

    function parseWords(text) {
      return text.split("\n").map(line => {
        const parts = line.split(":");
        if (parts.length === 2) {
          const word = parts[0].trim();
          const meaning = parts[1].trim();
          if (word && meaning) return { word, meaning };
        }
      }).filter(Boolean);
    }

    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function startQuiz() {
      const rawInput = document.getElementById('wordInput').value.trim();
      allWords = parseWords(rawInput);
      if (allWords.length === 0) {
        alert("ë‹¨ì–´ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }

      correctCount = 0;
      incorrectCount = 0;

      document.getElementById('inputSection').style.display = 'none';
      document.getElementById('quizBox').style.display = 'block';
      document.getElementById('scoreBox').style.display = 'none';

      startSet();
    }

    function startSet() {
      quizSet = shuffle([...allWords]);
      currentIndex = 0;
      nextQuestion();
    }

    function nextQuestion() {
      if (currentIndex >= quizSet.length) {
        showScore();
        return;
      }

      currentWord = quizSet[currentIndex++];
      document.getElementById('wordText').textContent = currentWord.word;
      document.getElementById('userAnswer').value = '';
      document.getElementById('resultMsg').textContent = '';
    }

    function checkAnswer() {
      const input = document.getElementById('userAnswer').value.trim();
      const resultEl = document.getElementById('resultMsg');
      if (input === currentWord.meaning) {
        resultEl.textContent = "âœ… ì •ë‹µì…ë‹ˆë‹¤!";
        resultEl.style.color = "green";
        correctCount++;
      } else {
        resultEl.textContent = `âŒ ì˜¤ë‹µ! ì •ë‹µì€: ${currentWord.meaning}`;
        resultEl.style.color = "red";
        incorrectCount++;
      }

      setTimeout(nextQuestion, 1500);
    }

    function showScore() {
      const total = correctCount + incorrectCount;
      const rate = ((correctCount / total) * 100).toFixed(1);

      document.getElementById('quizBox').style.display = 'none';
      document.getElementById('scoreBox').style.display = 'block';
      document.getElementById('scoreSummary').innerHTML = `
        ì´ ë¬¸ì œ ìˆ˜: ${total}ê°œ<br>
        ë§ì€ ê°œìˆ˜: ${correctCount}ê°œ<br>
        í‹€ë¦° ê°œìˆ˜: ${incorrectCount}ê°œ<br>
        ì •ë‹µë¥ : ${rate}%
      `;
    }

    function goToInput() {
      document.getElementById('inputSection').style.display = 'block';
      document.getElementById('scoreBox').style.display = 'none';
      // ì…ë ¥ì°½ ë‚´ìš©ì€ ìœ ì§€ë¨
    }
  </script>

</body>
</html>
